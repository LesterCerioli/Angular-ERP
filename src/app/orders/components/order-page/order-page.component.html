<app-base-page
  [saveButtonDisabled]="!vm.saveButtonEnabled"
  (save)="vm.save()">
  <span title>{{ 'orders.order-page' | translate }}</span>
  <span sub-title>{{ vm.subTitle$ | async }}</span>
  <form [formGroup]="vm.form">
    <mat-grid-list [cols]="vm.isMobile ? 1 : 3" rowHeight="64px">

      <mat-grid-tile>
        <mat-form-field>
          <mat-label>{{ 'orders.caption.type' | translate }}</mat-label>
          <mat-select formControlName="type">
            <mat-option *ngFor="let type of vm.orderTypes" [value]="type.value">
              {{type.name | translate}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </mat-grid-tile>

      <mat-grid-tile>
        <mat-form-field>
          <input matInput [placeholder]="'orders.caption.number' | translate" formControlName="number" />
        </mat-form-field>
      </mat-grid-tile>

      <mat-grid-tile>
        <mat-form-field>
          <input matInput [placeholder]="'orders.caption.quantity' | translate" formControlName="qty" type="number" />
        </mat-form-field>
      </mat-grid-tile>

      <mat-grid-tile>
        <mat-form-field>
          <input matInput [placeholder]="'orders.caption.customer' | translate" formControlName="customer" />
          <button mat-button matSuffix mat-icon-button *ngIf="vm.form?.get('customer').value" (click)="vm.form.get('customer').setValue(null)">
            <mat-icon>clear</mat-icon>
          </button>
          <button mat-button matSuffix mat-icon-button (click)="vm.openLookup('Customer', 'customer', vm.customersDisplayedColumns)">
            <mat-icon>search</mat-icon>
          </button>
        </mat-form-field>
      </mat-grid-tile>
      
      <mat-grid-tile>
        <mat-form-field>
          <input matInput [placeholder]="'orders.caption.item' | translate" formControlName="item" />
          <button mat-button matSuffix mat-icon-button *ngIf="vm.form?.get('item').value"
            (click)="vm.form.get('item').setValue(null)">
            <mat-icon>clear</mat-icon>
          </button>
          <button mat-button matSuffix mat-icon-button (click)="vm.openLookup('Item', 'item', vm.itemsDisplayedColumns)">
            <mat-icon>search</mat-icon>
          </button>
        </mat-form-field>
      </mat-grid-tile>

      <mat-grid-tile>
        <mat-form-field>
          <input matInput [placeholder]="'orders.caption.store' | translate" formControlName="store" />
          <button mat-button matSuffix mat-icon-button *ngIf="vm.form?.get('store').value"
            (click)="vm.form.get('store').setValue(null)">
            <mat-icon>clear</mat-icon>
          </button>
          <button mat-button matSuffix mat-icon-button (click)="vm.openLookup('Store', 'store', vm.storesDisplayedColumns)">
            <mat-icon>search</mat-icon>
          </button>
        </mat-form-field>
      </mat-grid-tile>

    </mat-grid-list>

    <mat-accordion>
      <app-order-features [formArray]="vm.form.get('features')"></app-order-features>
    </mat-accordion>
  </form>
</app-base-page>